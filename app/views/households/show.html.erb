<% content_for(:title, "Mon foyer") %>

<div class="max-w-2xl mx-auto space-y-6">
  <div class="flex flex-wrap items-center justify-between gap-3">
    <h1 class="text-xl sm:text-2xl font-bold text-gray-900"><%= @household.name %></h1>
    <%= link_to "Modifier", edit_household_path, class: "rounded-lg bg-gray-100 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200" %>
  </div>

  <!-- Members -->
  <div class="bg-white rounded-xl border border-gray-100 shadow-sm p-6">
    <h2 class="text-sm font-semibold text-gray-900 mb-4">Membres du foyer</h2>
    <ul class="space-y-3">
      <% @household.users.each do |user| %>
        <li class="flex items-center gap-3">
          <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-sm font-medium text-blue-700">
            <%= user.first_name[0] %><%= user.last_name[0] %>
          </div>
          <div>
            <p class="text-sm font-medium text-gray-900"><%= user.full_name %></p>
            <p class="text-xs text-gray-500"><%= user.email %></p>
          </div>
        </li>
      <% end %>
    </ul>

    <% if @household.solo? %>
      <div class="mt-4 p-3 rounded-lg bg-blue-50 border border-blue-200">
        <p class="text-sm text-blue-800 mb-3">Invitez votre partenaire avec ce lien :</p>
        <div class="flex gap-2 flex-wrap">
          <%= link_to "Rejoindre le foyer", join_household_url(token: @household.invitation_token), class: "rounded-lg bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700" %>
          <button type="button" id="copy-invite-link" class="rounded-lg bg-white px-3 py-2 text-sm font-medium text-gray-700 border border-gray-300 hover:bg-gray-50">
            Copier le lien
          </button>
        </div>
        <code id="invite-link" class="mt-2 block text-xs bg-white p-2 rounded border font-mono break-all text-gray-600 select-all cursor-pointer"><%= join_household_url(token: @household.invitation_token) %></code>
        <script>
          document.getElementById('copy-invite-link').addEventListener('click', function() {
            const link = document.getElementById('invite-link').textContent;
            navigator.clipboard.writeText(link).then(() => {
              const button = this;
              const originalText = button.textContent;
              button.textContent = 'CopiÃ© !';
              setTimeout(() => {
                button.textContent = originalText;
              }, 2000);
            }).catch(err => {
              console.error('Erreur:', err);
              alert('Impossible de copier le lien');
            });
          });
        </script>
      </div>
    <% end %>
  </div>
</div>
