<!-- Sidebar desktop -->
<div class="hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-64 lg:flex-col">
  < class="flex grow flex-col gap-y-5 overflow-y-auto border-r border-gray-200 bg-white px-6 pb-4">
    <!-- Logo -->
    <div class="flex h-16 shrink-0 items-center">
      <h1 class="text-xl font-bold text-slate-800">
        <svg class="inline-block w-6 h-6 mr-1 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
        </svg>
        Achat
      </h1>
    </div>

    <nav class="flex flex-1 flex-col">
      <ul role="list" class="flex flex-1 flex-col gap-y-7">
        <li>
          <ul role="list" class="-mx-2 space-y-1">
            <%= nav_link "Dashboard", dashboard_path, icon: "chart" %>
            <%= nav_link "Profil financier", financial_profile_path, icon: "currency" if current_household %>
            <%= nav_link "Critères", property_criterion_path, icon: "filter" if current_household&.property_criterion %>
            <%= nav_link "Biens", properties_path, icon: "building" if current_household %>
          </ul>
        </li>

        <li class="mt-auto">
          <div class="flex items-center gap-x-3 px-2 py-3 text-sm">
            <% if current_household %>
              <%= link_to household_path, class: "flex-1 min-w-0 rounded-lg hover:bg-gray-100 px-1 py-1" do %>
                <p class="text-sm font-medium text-gray-900 truncate"><%= current_user.full_name %></p>
                <p class="text-xs text-gray-500 truncate"><%= current_household.name %></p>
              <% end %>
            <% else %>
              <div class="flex-1 min-w-0">
                <p class="text-sm font-medium text-gray-900 truncate"><%= current_user.full_name %></p>
                <p class="text-xs text-gray-500 truncate">Pas de foyer</p>
              </div>
            <% end %>
            <%= link_to destroy_user_session_path, data: { turbo_method: :delete }, class: "text-gray-400 hover:text-gray-600 p-2" do %>
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
              </svg>
            <% end %>
          </div>
        </li>
      </ul>
    </nav>
  </div>
</div>

<!-- Mobile navigation -->
<div class="lg:hidden" data-controller="mobile-menu">
  <!-- Top bar mobile -->
  <div class="sticky top-0 z-40 flex items-center justify-between bg-white px-4 py-3 shadow-sm">
    <div class="flex items-center gap-2">
      <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
      </svg>
      <span class="text-lg font-bold text-gray-900">Achat</span>
    </div>
    <button
      type="button"
      data-mobile-menu-button
      data-action="click->mobile-menu#open"
      aria-expanded="false"
      aria-controls="mobile-drawer"
      class="inline-flex items-center justify-center w-11 h-11 rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
    >
      <span class="sr-only">Ouvrir le menu</span>
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
      </svg>
    </button>
  </div>

  <!-- Overlay -->
  <div
    data-mobile-menu-target="overlay"
    data-action="click->mobile-menu#close"
    class="hidden fixed inset-0 z-50 bg-black/40 backdrop-blur-sm"
    aria-hidden="true"
  ></div>

  <!-- Drawer -->
  <div
    id="mobile-drawer"
    data-mobile-menu-target="drawer"
    class="fixed inset-y-0 left-0 z-50 w-72 max-w-[85vw] bg-white shadow-xl transform -translate-x-full transition-transform duration-300 ease-in-out flex flex-col"
    aria-label="Navigation principale"
  >
    <!-- Drawer Header -->
    <div class="flex items-center justify-between px-5 py-4 border-b border-gray-100">
      <div class="flex items-center gap-2">
        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
        </svg>
        <span class="text-lg font-bold text-gray-900">Achat</span>
      </div>
      <button
        type="button"
        data-action="click->mobile-menu#close"
        class="inline-flex items-center justify-center w-10 h-10 rounded-lg text-gray-400 hover:bg-gray-100 hover:text-gray-600"
      >
        <span class="sr-only">Fermer le menu</span>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <!-- Drawer Nav -->
    <nav class="flex-1 overflow-y-auto px-4 py-4">
      <ul role="list" class="space-y-1">
        <%= nav_link "Dashboard", dashboard_path, icon: "chart" %>
        <% if current_household %>
          <%= nav_link "Profil financier", financial_profile_path, icon: "currency" %>
          <%= nav_link "Critères", property_criterion_path, icon: "filter" if current_household.property_criterion %>
          <%= nav_link "Biens", properties_path, icon: "building" %>
        <% end %>
      </ul>

      <% unless current_household %>
        <div class="mt-6 p-4 rounded-xl bg-blue-50 border border-blue-100">
          <p class="text-sm text-blue-700 mb-3">Créez votre foyer pour commencer</p>
          <%= link_to "Créer mon foyer", new_household_path, class: "block text-center rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500" %>
        </div>
      <% end %>
    </nav>

    <!-- Drawer Footer -->
    <div class="border-t border-gray-100 px-4 py-4">
      <% if current_household %>
        <%= link_to household_path, class: "flex items-center justify-between rounded-lg hover:bg-gray-100 p-2 -m-2 block" do %>
          <div class="min-w-0 flex-1">
            <p class="text-sm font-medium text-gray-900 truncate"><%= current_user.full_name %></p>
            <p class="text-xs text-gray-500 truncate"><%= current_household.name %></p>
          </div>
        <% end %>
      <% else %>
        <div class="flex items-center justify-between">
          <div class="min-w-0 flex-1">
            <p class="text-sm font-medium text-gray-900 truncate"><%= current_user.full_name %></p>
            <p class="text-xs text-gray-500 truncate">Pas de foyer</p>
          </div>
        </div>
      <% end %>
      <%= link_to destroy_user_session_path, data: { turbo_method: :delete }, class: "ml-3 inline-flex items-center justify-center w-10 h-10 rounded-lg text-gray-400 hover:bg-red-50 hover:text-red-600" do %>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
        </svg>
      <% end %>
      </div>
    </div>
  </div>
